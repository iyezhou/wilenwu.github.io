<!DOCTYPE html>





<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/github_apple.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/github32.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/github16.png?v=7.4.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.0" color="#222">
  <link rel="alternate" href="/atom.xml" title="Wilen's Blog" type="application/atom+xml">

<link rel="stylesheet" href="/css/main.css?v=7.4.0">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Great Vibes:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.4.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":"mac"},
    back2top: {"enable":true,"sidebar":true,"scrollpercent":true},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: true,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="Hive是一个数据仓库基础工具，在Hadoop中用来处理结构化数据。">
<meta name="keywords" content="大数据,hive,SQL,hiveQL">
<meta property="og:type" content="article">
<meta property="og:title" content="大数据手册(Hive)--HiveQL">
<meta property="og:url" content="https://wilenwu.github.io/posts/big-data/BigDataNotebook(Hive)--HiveQL.html">
<meta property="og:site_name" content="Wilen&#39;s Blog">
<meta property="og:description" content="Hive是一个数据仓库基础工具，在Hadoop中用来处理结构化数据。">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-09-30T06:39:03.716Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="大数据手册(Hive)--HiveQL">
<meta name="twitter:description" content="Hive是一个数据仓库基础工具，在Hadoop中用来处理结构化数据。">
  <link rel="canonical" href="https://wilenwu.github.io/posts/big-data/BigDataNotebook(Hive)--HiveQL">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>
<script> 
 (function(){
        if(''){
            if (prompt('请输入文章密码') !== ''){
                alert('密码错误！');
                history.back();
            }
        }
    })();
</script>

  <title>大数据手册(Hive)--HiveQL | Wilen's Blog</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?873a3ba02856122b60c91114a489f967";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Wilen's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <h1 class="site-subtitle" itemprop="description">∞</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-tags">
      
    
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签<span class="badge">111</span></a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-categories">
      
    
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类<span class="badge">24</span></a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档<span class="badge">60</span></a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-bookshelf">
      
    
      
    

    <a href="/bookshelf/" rel="section"><i class="menu-item-icon fa fa-fw fa-windows"></i> <br>书架</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-favorites">
      
    
      
    

    <a href="/favorites/" rel="section"><i class="menu-item-icon fa fa-fw fa-star"></i> <br>收藏夹</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-about">
      
    
      
    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a href="javascript:;" class="popup-trigger">
        
          <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
      </li>
    
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="搜索..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    

  <a href="https://github.com/wilenwu" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
      <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block post">
    <link itemprop="mainEntityOfPage" href="https://wilenwu.github.io/posts/big-data/BigDataNotebook(Hive)--HiveQL.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Wilen Wu">
      <meta itemprop="description" content="个人技术博客">
      <meta itemprop="image" content="/images/header.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wilen's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">大数据手册(Hive)--HiveQL

          
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2018-07-03 17:57:36" itemprop="dateCreated datePublished" datetime="2018-07-03T17:57:36+08:00">2018-07-03</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-09-30 14:39:03" itemprop="dateModified" datetime="2019-09-30T14:39:03+08:00">2019-09-30</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Big-Data/" itemprop="url" rel="index"><span itemprop="name">Big Data</span></a></span>

                
                
              
            </span>
          

          
            <span id="/posts/big-data/BigDataNotebook(Hive)--HiveQL.html" class="post-meta-item leancloud_visitors" data-flag-title="大数据手册(Hive)--HiveQL" title="热度">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">热度：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
        
      
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/posts/big-data/BigDataNotebook(Hive)--HiveQL.html#comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/posts/big-data/BigDataNotebook(Hive)--HiveQL.html" itemprop="commentCount"></span></a>
  </span>
  
  
          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
              
                <span class="post-meta-item-text">本文字数：</span>
              
              <span>12k</span>
            </span>
          
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
              
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              
              <span>11 分钟</span>
            </span>
          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>Hive是一个数据仓库基础工具，在Hadoop中用来处理结构化数据。</p>
<a id="more"></a>
<h1 id="hive交互"><a class="markdownIt-Anchor" href="#hive交互"></a> Hive交互</h1>
<p><strong>hive启动</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">hive [--database dbname]  <span class="comment">##进入CLI交互界面，默认进入default数据库</span></span><br><span class="line">hive -v  <span class="comment">##冗余verbose模式，额外打印出执行的HQL语句</span></span><br><span class="line">hive -S  <span class="comment">##静默Slient模式，不显示转化MR-Job的信息，只显示最终结果</span></span><br><span class="line">hive -i <span class="string">'hive-init.sql'</span>  <span class="comment">##进入Hive交互Shell时候先执行脚本中的HQL语句</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#-----web管理</span></span><br><span class="line">hive --service serviceName    <span class="comment">##启动web服务</span></span><br><span class="line"><span class="comment">#打开web页面</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#-----hive 远程服务</span></span><br><span class="line">hive --serve hiveserve &amp;</span><br></pre></td></tr></table></figure>
<p><strong>hive命令行交互模式</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select * from dummy   <span class="comment">#执行HiveQL语句</span></span><br><span class="line">hive&gt; <span class="built_in">source</span> ./hive-script.sql  <span class="comment">##执行HQL脚本</span></span><br><span class="line">hive&gt; !<span class="built_in">echo</span> <span class="string">'hello hive'</span>      <span class="comment">##执行shell命令，前面加 ！即可</span></span><br></pre></td></tr></table></figure>
<p><strong>shell窗口执行hive语句</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hive -e <span class="string">'show tables;'</span>  <span class="comment">##从命令行执行指定的HQL</span></span><br><span class="line">hive -f <span class="string">'hive-script.sql'</span>  <span class="comment">##执行HQL脚本</span></span><br><span class="line">hive -S -e <span class="string">'show tables;'</span>  <span class="comment">##静默模式</span></span><br></pre></td></tr></table></figure>
<h1 id="hive内置运算符"><a class="markdownIt-Anchor" href="#hive内置运算符"></a> Hive内置运算符</h1>
<table>
<thead>
<tr>
<th style="text-align:left">关系运算符</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">A = B</td>
<td style="text-align:left">等于</td>
</tr>
<tr>
<td style="text-align:left">A != B</td>
<td style="text-align:left">不等于</td>
</tr>
<tr>
<td style="text-align:left">A &lt; B</td>
<td style="text-align:left">小于</td>
</tr>
<tr>
<td style="text-align:left">A &lt;= B</td>
<td style="text-align:left">大于等于</td>
</tr>
<tr>
<td style="text-align:left">A &gt; B</td>
<td style="text-align:left">大于</td>
</tr>
<tr>
<td style="text-align:left">A &gt;= B</td>
<td style="text-align:left">大于等于</td>
</tr>
<tr>
<td style="text-align:left">A IS NULL</td>
<td style="text-align:left">空值</td>
</tr>
<tr>
<td style="text-align:left">A IS NOT NULL</td>
<td style="text-align:left">非空</td>
</tr>
<tr>
<td style="text-align:left">A LIKE B</td>
<td style="text-align:left">如果字符串模式A匹配到B，使用通配符，例如<code>%</code></td>
</tr>
<tr>
<td style="text-align:left">A RLIKE B</td>
<td style="text-align:left">如果A任何子字符串匹配正则表达式B</td>
</tr>
<tr>
<td style="text-align:left">A REGEXP B</td>
<td style="text-align:left">字符串，同于RLIKE.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>算数运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>A + B</td>
<td></td>
</tr>
<tr>
<td>A - B</td>
<td></td>
</tr>
<tr>
<td>A * B</td>
<td></td>
</tr>
<tr>
<td>A / B</td>
<td></td>
</tr>
<tr>
<td>A % B</td>
<td>余数</td>
</tr>
<tr>
<td>A &amp; B</td>
<td>A和B的按位与结果</td>
</tr>
<tr>
<td>A | B</td>
<td>A和B的按位或结果</td>
</tr>
<tr>
<td>A ^ B</td>
<td>A和B的按位异或结果</td>
</tr>
<tr>
<td>~A</td>
<td>A按位非的结果</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>逻辑运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>A AND B</td>
<td></td>
</tr>
<tr>
<td>A &amp;&amp; B</td>
<td>类似于 A AND B.</td>
</tr>
<tr>
<td>A OR B</td>
<td></td>
</tr>
<tr>
<td>A || B</td>
<td>类似于 A OR B.</td>
</tr>
<tr>
<td>NOT A</td>
<td></td>
</tr>
<tr>
<td>!A</td>
<td>类似于 NOT A.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>复杂运算符</th>
<th>操作</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>A[n]</td>
<td>A是一个数组，n是一个int</td>
<td>它返回数组A的第n个元素，第一个元素的索引0。</td>
</tr>
<tr>
<td>M[key]</td>
<td>M 是一个 Map&lt;K, V&gt; 并 key 的类型为K</td>
<td>它返回对应于映射中关键字的值。</td>
</tr>
<tr>
<td>S.x</td>
<td>S 是一个结构</td>
<td>它返回S的s字段</td>
</tr>
</tbody>
</table>
<h1 id="hive数据类型"><a class="markdownIt-Anchor" href="#hive数据类型"></a> Hive数据类型</h1>
<table>
<thead>
<tr>
<th style="text-align:left">数据类型</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">tinyint/smallint/int/bigint</td>
<td style="text-align:left">整数类型</td>
</tr>
<tr>
<td style="text-align:left">float/double</td>
<td style="text-align:left">浮点型</td>
</tr>
<tr>
<td style="text-align:left">Boolean</td>
<td style="text-align:left">布尔类型</td>
</tr>
<tr>
<td style="text-align:left">string<br>varchar(n)/char(n)</td>
<td style="text-align:left">字符串类型</td>
</tr>
<tr>
<td style="text-align:left"><code>array&lt;data_type&gt;</code></td>
<td style="text-align:left">数组类型,同一类型<code>[val1,val2,...]</code></td>
</tr>
<tr>
<td style="text-align:left"><code>map&lt;key_type,value_type&gt;</code></td>
<td style="text-align:left">集合类型,<code>&lt;key,value&gt;</code></td>
</tr>
<tr>
<td style="text-align:left"><code>struct&lt;name1:type1,name2:type2,...&gt;</code></td>
<td style="text-align:left">结构类型,包含不同类型</td>
</tr>
<tr>
<td style="text-align:left"><strong>时间类型</strong></td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">date</td>
<td style="text-align:left">只有日期部分</td>
</tr>
<tr>
<td style="text-align:left">timestamp</td>
<td style="text-align:left">时间戳</td>
</tr>
</tbody>
</table>
<h1 id="hive的数据存储"><a class="markdownIt-Anchor" href="#hive的数据存储"></a> Hive的数据存储</h1>
<ul>
<li>基于HDFS</li>
<li>内部表 table：我们删除表的时候在hdfs上对应的目录及数据文件一同被删除了</li>
<li>分区表 partition：对于数据库中的超大型表，可以通过把它的数据分成若干个小表，从而简化数据库的管理活动</li>
<li>外部表 external：受控表在删除一个表的时候,会把hdfs中的目录给删除掉,外部表是你在删除这个表的时候只删除了表定义,对于h</li>
<li>桶表 bucket：经过hash运算后方在不同的桶中</li>
</ul>
<h1 id="hiveql常用语句"><a class="markdownIt-Anchor" href="#hiveql常用语句"></a> HiveQL常用语句</h1>
<p>HiveQL是Hive支持的类似于SQL的查询语言。HiveQL大体可以分成下面两种类型</p>
<ul>
<li>DDL(data definition language)  比如创建数据库(create database),创建表(create table),数据库和表的删除</li>
<li>DML(data manipulation language) 数据的添加，查询</li>
<li>UDF(user defined function) Hive还支持用户自定义查询函数</li>
</ul>
<h2 id="创建删除数据库"><a class="markdownIt-Anchor" href="#创建删除数据库"></a> 创建/删除数据库</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> [<span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] userdb;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">DATABASE</span> [<span class="keyword">IF</span> <span class="keyword">EXISTS</span>] userdb;</span><br></pre></td></tr></table></figure>
<h2 id="创建删除表"><a class="markdownIt-Anchor" href="#创建删除表"></a> 创建/删除表</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-------创建表</span></span><br><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">EXTERNAL</span>] <span class="keyword">TABLE</span> [<span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] userdb.table_name (</span><br><span class="line"><span class="keyword">id</span> <span class="keyword">string</span> <span class="keyword">COMMENT</span> <span class="string">'主键'</span>,</span><br><span class="line"><span class="keyword">name</span> <span class="keyword">string</span> <span class="keyword">COMMENT</span> <span class="string">'字符'</span>,</span><br><span class="line">age <span class="built_in">int</span> <span class="keyword">COMMENT</span> <span class="string">'整数'</span>,</span><br><span class="line">married <span class="built_in">boolean</span> <span class="keyword">COMMENT</span> <span class="string">'布尔类型'</span>, </span><br><span class="line">arr <span class="built_in">array</span>&lt;<span class="keyword">map</span>&lt;<span class="keyword">string</span>,<span class="built_in">int</span>&gt;&gt; <span class="keyword">COMMENT</span> <span class="string">'map数组'</span>,</span><br><span class="line">info <span class="keyword">struct</span>&lt;addr:<span class="keyword">string</span>,height:<span class="keyword">double</span>,birth:<span class="built_in">date</span>&gt; <span class="keyword">COMMENT</span> <span class="string">'结构类型'</span>,</span><br><span class="line">)</span><br><span class="line"><span class="keyword">COMMENT</span> <span class="string">'表注释'</span></span><br><span class="line">PARTITIONED <span class="keyword">BY</span>(</span><br><span class="line"><span class="built_in">date</span> <span class="keyword">STRING</span> <span class="keyword">COMMENT</span> <span class="string">'日期分区'</span>, </span><br><span class="line">sex <span class="keyword">STRING</span> <span class="keyword">COMMENT</span> <span class="string">'性别分区'</span></span><br><span class="line">)</span><br><span class="line">CLUSTERED <span class="keyword">BY</span>(<span class="keyword">id</span>) SORTED <span class="keyword">BY</span>(<span class="keyword">num</span>) <span class="keyword">INTO</span> <span class="number">32</span> BUCKETS</span><br><span class="line"><span class="keyword">ROW</span> <span class="keyword">FORMAT</span> <span class="keyword">DELIMITED</span> <span class="string">'\t'</span></span><br><span class="line">   <span class="keyword">FIELDS</span> <span class="keyword">TERMINATED</span> <span class="keyword">BY</span> <span class="string">'\t'</span></span><br><span class="line"><span class="keyword">STORED</span> <span class="keyword">AS</span> SEQUENCEFILE;</span><br><span class="line">LOCATION 'hdfs_path';</span><br><span class="line"></span><br><span class="line"><span class="comment">--加上EXTERNAL时，建立外部表</span></span><br><span class="line"><span class="comment">--PARTITIONED BY 关键字建分区表</span></span><br><span class="line"><span class="comment">--CLUSTERED BY 关键字建Bucket表</span></span><br><span class="line"><span class="comment">--STORED AS 存储类型&#123;SEQUENCEFILE:需要压缩,TEXTFILE:纯文本,RCFILE&#125;</span></span><br><span class="line"><span class="comment">--LOCATION添加外部表存储路径</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--------创建空表，复制表结构</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> [<span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] empty_tablename</span><br><span class="line"><span class="keyword">LIKE</span> other_tablename;</span><br><span class="line"><span class="comment">--------直接导入数据</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> [<span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] table_name</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> ...;</span><br><span class="line"><span class="comment">--------删除表</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> [<span class="keyword">IF</span> <span class="keyword">EXISTS</span>] table_name;</span><br></pre></td></tr></table></figure>
<h2 id="修改表结构"><a class="markdownIt-Anchor" href="#修改表结构"></a> 修改表结构</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">COLUMNS</span> (column_name [<span class="keyword">string</span> <span class="keyword">COMMENT</span> <span class="string">'新列'</span>],...),</span><br><span class="line"><span class="keyword">DROP</span> [<span class="keyword">COLUMN</span>] column_name,</span><br><span class="line"><span class="keyword">RENAME</span> <span class="keyword">TO</span> new_name,                      <span class="comment">--重命名表名</span></span><br><span class="line"><span class="keyword">CHANGE</span> column_name new_name new_type,</span><br><span class="line"><span class="keyword">REPLACE</span> <span class="keyword">COLUMNS</span> (...);                   <span class="comment">--替换表中所有字段</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--添加/删除分区</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name</span><br><span class="line"><span class="keyword">ADD</span> [<span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] <span class="keyword">PARTITION</span> (y=<span class="string">'2018'</span>,m=<span class="string">'07'</span>),</span><br><span class="line"><span class="keyword">DROP</span> [<span class="keyword">IF</span> <span class="keyword">EXISTS</span>] <span class="keyword">PARTITION</span> (y=<span class="string">'2018'</span>,m=<span class="string">'07'</span>)；</span><br><span class="line"></span><br><span class="line"><span class="comment">--重命名分区</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name <span class="keyword">PARTITION</span> (y=<span class="string">'2018'</span>,m=<span class="string">'07'</span>) </span><br><span class="line"><span class="keyword">RENAME</span> <span class="keyword">TO</span> <span class="keyword">PARTITION</span> (y=<span class="string">'18'</span>,m=<span class="string">'07'</span>);</span><br></pre></td></tr></table></figure>
<h2 id="导入导出数据"><a class="markdownIt-Anchor" href="#导入导出数据"></a> 导入导出数据</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--LOAD命令可以导入本地数据或者hdfs数据</span></span><br><span class="line"><span class="keyword">LOAD</span> <span class="keyword">DATA</span> [<span class="keyword">LOCAL</span>] INPATH <span class="string">'filepath'</span> [OVERWRITE] <span class="keyword">INTO</span> <span class="keyword">TABLE</span> table_name </span><br><span class="line"><span class="keyword">PARTITION</span> (</span><br><span class="line"><span class="built_in">date</span>=<span class="string">'2018-07-03'</span>, </span><br><span class="line">sex=<span class="string">'M'</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">--LOCAL是标识符指定本地路径。它是可选的</span></span><br><span class="line"><span class="comment">--OVERWRITE是可选的，覆盖表中的数据</span></span><br><span class="line"><span class="comment">--PARTITION分区</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--将hive数据导出到本地</span></span><br><span class="line"><span class="keyword">INSERT</span> OVERWRITE <span class="keyword">LOCAL</span> <span class="keyword">DIRECTORY</span> <span class="string">'hdfs_path'</span>  </span><br><span class="line"><span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\t'</span> </span><br><span class="line"><span class="keyword">select</span> ...;</span><br><span class="line"></span><br><span class="line"><span class="comment">--将hive数据放到hdfs文件系统中</span></span><br><span class="line"><span class="keyword">INSERT</span> OVERWRITE  <span class="keyword">DIRECTORY</span> <span class="string">'hdfs_path'</span> </span><br><span class="line"><span class="keyword">SELECT</span> ...;</span><br></pre></td></tr></table></figure>
<h2 id="插入数据"><a class="markdownIt-Anchor" href="#插入数据"></a> 插入数据</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--将查询结果插入Hive表</span></span><br><span class="line"><span class="keyword">INSERT</span> OVERWRITE|<span class="keyword">INTO</span>  <span class="keyword">table</span> table_name </span><br><span class="line"><span class="keyword">PARTITION</span> (y=<span class="string">'2018'</span>,m=<span class="string">'07'</span>)</span><br><span class="line"><span class="keyword">SELECT</span> ...;</span><br><span class="line"></span><br><span class="line"><span class="comment">--插入单条数据 （Hive 已支持单条插入）</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table_name  <span class="keyword">VALUES</span>(<span class="string">'num'</span>,<span class="number">10086</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--将查询结果写入HDFS文件系统</span></span><br><span class="line"><span class="keyword">INSERT</span> OVERWRITE <span class="keyword">DIRECTORY</span> <span class="string">'hdfs_path'</span> </span><br><span class="line"><span class="keyword">SELECT</span> ...;</span><br></pre></td></tr></table></figure>
<h2 id="查询语句"><a class="markdownIt-Anchor" href="#查询语句"></a> 查询语句</h2>
<p>select查询支持正则表达式（select `patt`)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">ALL</span> | <span class="keyword">DISTINCT</span>] select_expr, select_expr, ... </span><br><span class="line"><span class="keyword">FROM</span> table_reference </span><br><span class="line">[<span class="keyword">WHERE</span> where_condition]</span><br><span class="line">[<span class="keyword">GROUP</span> <span class="keyword">BY</span> col_list]</span><br><span class="line">[<span class="keyword">HAVING</span> having_condition] <span class="comment">--可筛选聚合后结果</span></span><br><span class="line">[CLUSTER <span class="keyword">BY</span> col_list | [<span class="keyword">DISTRIBUTE</span> <span class="keyword">BY</span> col_list] [<span class="keyword">SORT</span> <span class="keyword">BY</span> col_list]] </span><br><span class="line">[<span class="keyword">ORDER</span> <span class="keyword">BY</span> col_list]</span><br><span class="line">[<span class="keyword">LIMIT</span> <span class="built_in">number</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">#hive特殊用法，提出部分字段</span></span><br><span class="line"><span class="keyword">set</span> hive.support.quoted.identifiers=<span class="keyword">none</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="string">`(y|m|d)?+.+`</span> <span class="keyword">from</span>  employee;</span><br></pre></td></tr></table></figure>
<h2 id="表连接"><a class="markdownIt-Anchor" href="#表连接"></a> 表连接</h2>
<p><strong>只支持等值连接</strong></p>
<img alt="join" style="zoom: 45%;" data-src="/images/hive_join.png">
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">column</span>,... <span class="keyword">from</span> tableA</span><br><span class="line"><span class="comment">--内连接</span></span><br><span class="line">[<span class="keyword">INNER</span>] <span class="keyword">JOIN</span> tableB [<span class="keyword">ON</span> join_condition]</span><br><span class="line"><span class="comment">--左/右/全连接</span></span><br><span class="line">&#123;<span class="keyword">LEFT</span>|<span class="keyword">RIGHT</span>|<span class="keyword">FULL</span>&#125; [<span class="keyword">OUTER</span>] <span class="keyword">JOIN</span> tableB <span class="keyword">ON</span> join_condition</span><br><span class="line"><span class="comment">--差集连接</span></span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">SEMI</span> <span class="keyword">JOIN</span> tableB <span class="keyword">ON</span> join_condition</span><br><span class="line"><span class="comment">--笛卡儿积（on语句可以去除）</span></span><br><span class="line"><span class="keyword">CROSS</span> <span class="keyword">JOIN</span> tableB [<span class="keyword">ON</span> join_condition]</span><br></pre></td></tr></table></figure>
<p><strong>Example</strong></p>
<p>购物记录表(shopping_records)，节假日表(holidays)，输出节假日购物记录</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; SELECT * FROM shopping_records limit 3;</span><br><span class="line">+<span class="comment">------+--------+-------------+------------+--------+</span></span><br><span class="line">| id   | userid | channel     | date       | amount |</span><br><span class="line">+<span class="comment">------+--------+-------------+------------+--------+</span></span><br><span class="line">| 001  | u1005  | wechart     | 2018-11-11 |   1024 |</span><br><span class="line">| 002  | u1005  | alipay      | 2018-10-03 |   5050 |</span><br><span class="line">| 003  | u1203  | credit_card | 2018-12-12 |   2048 |</span><br><span class="line">+<span class="comment">------+--------+-------------+------------+--------+</span></span><br><span class="line">hive&gt; SELECT * FROM holidays limit 3;</span><br><span class="line">+<span class="comment">-----------------+------------+------------+</span></span><br><span class="line">| name            | start_date | end_date   |</span><br><span class="line">+<span class="comment">-----------------+------------+------------+</span></span><br><span class="line">| Spring Festival | 2018-02-15 | 2018-02-21 |</span><br><span class="line">| National Day    | 2018-10-01 | 2018-10-07 |</span><br><span class="line">| New Year's Day  | 2017-12-30 | 2018-01-01 |</span><br><span class="line">+<span class="comment">-----------------+------------+------------+</span></span><br><span class="line">hive&gt; --JOIN...ON语句</span><br><span class="line">hive&gt; SELECT DISTINCT a.*</span><br><span class="line">hive&gt; FROM shopping_records a</span><br><span class="line">hive&gt; JOIN holidays b ON 1=1 --ON语句可以省略</span><br><span class="line">hive&gt; WHERE date BETWEEN start_date AND end_date;</span><br><span class="line"></span><br><span class="line">hive&gt; --CROSS JOIN笛卡儿积</span><br><span class="line">hive&gt; SELECT DISTINCT a.*</span><br><span class="line">hive&gt; FROM shopping_records a</span><br><span class="line">hive&gt; CROSS JOIN holidays b</span><br><span class="line">hive&gt; WHERE date BETWEEN start_date AND end_date;</span><br><span class="line"></span><br><span class="line">hive&gt; --直接select笛卡儿积</span><br><span class="line">hive&gt; SELECT DISTINCT a.* FROM shopping_records a,holidays b</span><br><span class="line">hive&gt; WHERE date BETWEEN start_date AND end_date;</span><br><span class="line"></span><br><span class="line">hive&gt; --输出</span><br><span class="line">+<span class="comment">------+--------+-------------+------------+--------+</span></span><br><span class="line">| id   | userid | channel     | date       | amount |</span><br><span class="line">+<span class="comment">------+--------+-------------+------------+--------+</span></span><br><span class="line">| 002  | u1005  | alipay      | 2018-10-03 |   5050 |</span><br><span class="line">| ...  | ...    | ...         | ...        |   ...  |</span><br><span class="line">+<span class="comment">------+--------+-------------+------------+--------+</span></span><br></pre></td></tr></table></figure>
<h2 id="表联合"><a class="markdownIt-Anchor" href="#表联合"></a> 表联合</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--联合语句（加上all不会自动去重）</span></span><br><span class="line">select_statement </span><br><span class="line">UNION [ALL] select_statement </span><br><span class="line">UNION [ALL] select_statement</span><br><span class="line">... ... ;</span><br></pre></td></tr></table></figure>
<h2 id="其他常用命令"><a class="markdownIt-Anchor" href="#其他常用命令"></a> 其他常用命令</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">DATABASES</span>/<span class="keyword">TABLES</span>;    <span class="comment">--查看数据库/表</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">DATABASES</span>/<span class="keyword">TABLES</span> <span class="keyword">LIKE</span> <span class="string">"*keyword*"</span>；</span><br><span class="line"><span class="keyword">USE</span> db_name;             <span class="comment">--连接数据库db_name</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">PARTITIONS</span> test_table;   <span class="comment">--查看分区</span></span><br><span class="line"><span class="keyword">SHOW</span> FUNCTIONS;             <span class="comment">--查看内置函数</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> table_name;  <span class="comment">-- 查看建表语句</span></span><br><span class="line">DESC table_name;           <span class="comment">-- 表结构</span></span><br><span class="line">DESC formatted table_name  <span class="comment">--查看表更新时间</span></span><br><span class="line">DESC formatted table_name partition(name=value) <span class="comment">--查看分区更新时间</span></span><br><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">select</span> * <span class="keyword">from</span> dual;    <span class="comment">-- 解释语句</span></span><br><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> table_name;     <span class="comment">-- 清空表</span></span><br></pre></td></tr></table></figure>
<h1 id="hive常用内置函数"><a class="markdownIt-Anchor" href="#hive常用内置函数"></a> Hive常用内置函数</h1>
<blockquote>
<p><a href="https://www.cnblogs.com/MOBIN/p/5618747.html" target="_blank" rel="noopener">Hive2.0函数大全(中文版)</a></p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:left">创建</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">array(value1,value2,…)</td>
<td style="text-align:left">创建数组</td>
</tr>
<tr>
<td style="text-align:left">map(key1,value1,key2,value2,…)</td>
<td style="text-align:left">创建字典</td>
</tr>
</tbody>
</table>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--将学生按score随机平均分配班级</span></span><br><span class="line">hive&gt; desc students;</span><br><span class="line">id	string</span><br><span class="line">score	string</span><br><span class="line"></span><br><span class="line">hive&gt; create table tmp</span><br><span class="line">hive&gt; as</span><br><span class="line">hive&gt; select id,score,</span><br><span class="line">hive&gt; case when score='A' then array('class 1','class 2')</span><br><span class="line">hive&gt;      when score='B' then array('class 3','class 4')</span><br><span class="line">hive&gt;      when score='C' then array('class 5','class 6')</span><br><span class="line">hive&gt; else null end as class</span><br><span class="line">hive&gt; from students;</span><br><span class="line"></span><br><span class="line">hive&gt; select id,score,</span><br><span class="line">hive&gt; case when rn%2=0 then class[0] else class[1] end as class</span><br><span class="line">hive&gt; from</span><br><span class="line">hive&gt; (select *,row_number() over(partition by score order by rand()) as rn from tmp) a</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:left">数学函数</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">count/sum/max/min/avg</td>
<td style="text-align:left">聚合函数</td>
</tr>
<tr>
<td style="text-align:left">exp(a)</td>
<td style="text-align:left">e<sup>a</sup></td>
</tr>
<tr>
<td style="text-align:left">pow(a,b)</td>
<td style="text-align:left">a<sup>b</sup></td>
</tr>
<tr>
<td style="text-align:left">sqrt(a)</td>
<td style="text-align:left">平方根</td>
</tr>
<tr>
<td style="text-align:left">ln/log2/log10/log(base,a)</td>
<td style="text-align:left">对数</td>
</tr>
<tr>
<td style="text-align:left">round(num,n)</td>
<td style="text-align:left">四舍五入</td>
</tr>
<tr>
<td style="text-align:left">floor(num)</td>
<td style="text-align:left">地板</td>
</tr>
<tr>
<td style="text-align:left">ceil(num)</td>
<td style="text-align:left">天花板</td>
</tr>
<tr>
<td style="text-align:left">rand(), rand(int,seed)</td>
<td style="text-align:left">随机数</td>
</tr>
<tr>
<td style="text-align:left">abs(a)</td>
<td style="text-align:left">绝对值</td>
</tr>
<tr>
<td style="text-align:left">sign(a)</td>
<td style="text-align:left">如果a是正数则返回1.0，是负数则返回-1.0，否则返回0.0</td>
</tr>
<tr>
<td style="text-align:left">e()/pi()</td>
<td style="text-align:left">常数e/pi</td>
</tr>
<tr>
<td style="text-align:left">greatest(T v1, T v2, …)</td>
<td style="text-align:left">最大值</td>
</tr>
<tr>
<td style="text-align:left">least(T v1, T v2, …)</td>
<td style="text-align:left">最小值</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:left">集合函数</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>size(Map&lt;K.V&gt;)</code></td>
<td style="text-align:left">它返回在映射类型的元素的数量。</td>
</tr>
<tr>
<td style="text-align:left"><code>size(Array&lt;T&gt;)</code></td>
<td style="text-align:left">它返回在数组类型元素的数量。</td>
</tr>
<tr>
<td style="text-align:left">collect_set(col)</td>
<td style="text-align:left">行转数组(去重)</td>
</tr>
<tr>
<td style="text-align:left">collect_list(col)</td>
<td style="text-align:left">行转数组(不去重)</td>
</tr>
<tr>
<td style="text-align:left"><code>array_contains(Array&lt;T&gt;, value)</code></td>
<td style="text-align:left">数组中是否包含value</td>
</tr>
<tr>
<td style="text-align:left">explode(ARRAY)</td>
<td style="text-align:left">数组转行</td>
</tr>
<tr>
<td style="text-align:left"><code>explode(Map&lt;K.V&gt;)</code></td>
<td style="text-align:left">每行对应每个map的key-value，返回key,value两个字段</td>
</tr>
<tr>
<td style="text-align:left"><code>map_keys(Map&lt;K.V&gt;)</code></td>
<td style="text-align:left">返回所有的keys</td>
</tr>
<tr>
<td style="text-align:left"><code>map_values(Map&lt;K.V&gt;)</code></td>
<td style="text-align:left">返回所有的values</td>
</tr>
<tr>
<td style="text-align:left"><code>sort_array(Array&lt;T&gt;)</code></td>
<td style="text-align:left">对数据进行排序返回</td>
</tr>
<tr>
<td style="text-align:left">concat_ws(sep,array)</td>
<td style="text-align:left">将array中的元素合并成字符</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; desc student;</span><br><span class="line">id	string</span><br><span class="line">chinese	float</span><br><span class="line">math	float</span><br><span class="line">english float</span><br><span class="line"></span><br><span class="line">hive&gt; desc student2;</span><br><span class="line">col_name	data_type	<span class="keyword">comment</span></span><br><span class="line"><span class="keyword">id</span>	<span class="keyword">string</span></span><br><span class="line">course	<span class="keyword">string</span></span><br><span class="line">score	<span class="built_in">float</span></span><br><span class="line"></span><br><span class="line">hive&gt; <span class="keyword">select</span> <span class="keyword">id</span>,<span class="built_in">array</span>(chinese,math,english) <span class="keyword">as</span> score <span class="keyword">from</span> student1;</span><br><span class="line">id	score</span><br><span class="line">001	[90,95,80]</span><br><span class="line">002	[70,65,83]</span><br><span class="line">... ...</span><br><span class="line">hive&gt; select id,map('c',chinese,'m',math,'e',english) as score from student1;</span><br><span class="line">id	score</span><br><span class="line">001	&#123;'c':90,'m':95,'e':80&#125;</span><br><span class="line">002	&#123;'c':70,'m':65,'e':83&#125;</span><br><span class="line">... ...</span><br><span class="line">hive&gt; select id,collect_set(score) as score from student2; --行收集成数组</span><br><span class="line">id	score</span><br><span class="line">001	[90,95,80]</span><br><span class="line">002	[70,65,83]</span><br><span class="line">... ...</span><br><span class="line"></span><br><span class="line">hive&gt; SELECT id, avg(score) FROM </span><br><span class="line">hive&gt; (select id,array(chinese,math,english) as score from student1) a</span><br><span class="line">hive&gt; LATERAL VIEW explode(score) adTable AS score GROUP BY id; --数组分解成行，并聚合运算</span><br><span class="line"></span><br><span class="line">hive&gt; select id,course,score from</span><br><span class="line">hive&gt; (select id,map('c',chinese,'m',math,'e',english) as dict from student1) a</span><br><span class="line">hive&gt; LATERAL VIEW explode(dict) adTable AS course,score; </span><br><span class="line">hive&gt; ---分解字典并转行，重命名时逗号分隔（union函数替代品）</span><br><span class="line">id	course	score</span><br><span class="line">001	c	90</span><br><span class="line">001	m	95</span><br><span class="line">001	e	80</span><br><span class="line">... ...</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:left">常用</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">corr(col1, col2)</td>
<td style="text-align:left">相关系数</td>
</tr>
<tr>
<td style="text-align:left">length(string)</td>
<td style="text-align:left">字符串长度</td>
</tr>
<tr>
<td style="text-align:left">concat(string A, string B,…)</td>
<td style="text-align:left">它返回从A后串联B产生的字符串</td>
</tr>
<tr>
<td style="text-align:left">concat_ws(sep,string A, string B,…)</td>
<td style="text-align:left">指定分隔符合并</td>
</tr>
<tr>
<td style="text-align:left">concat_ws(sep,array)</td>
<td style="text-align:left">将array中的元素合并成字符</td>
</tr>
<tr>
<td style="text-align:left">substr(string A, int start, int length)</td>
<td style="text-align:left">取子集</td>
</tr>
<tr>
<td style="text-align:left">upper(string A)/lower</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">trim(string A)</td>
<td style="text-align:left">删除两侧空格</td>
</tr>
<tr>
<td style="text-align:left">ltrim(string A)/rtrim(string A)</td>
<td style="text-align:left">删除左/右空格</td>
</tr>
<tr>
<td style="text-align:left">regexp_replace(string A, string B, string C)</td>
<td style="text-align:left">用C替换B</td>
</tr>
<tr>
<td style="text-align:left">split(str,pat)</td>
<td style="text-align:left">分割字符串，返回array</td>
</tr>
<tr>
<td style="text-align:left">percentile_approx(col, p，B)</td>
<td style="text-align:left">百分位数</td>
</tr>
<tr>
<td style="text-align:left"><code>cast(&lt;expr&gt; as &lt;type&gt;)</code></td>
<td style="text-align:left">将表达式的结果转换类型</td>
</tr>
<tr>
<td style="text-align:left">case when … then…else…end</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">between…and…</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">if(condition,valueTrue,valueFalseorNull)</td>
<td style="text-align:left">条件判断</td>
</tr>
<tr>
<td style="text-align:left">nvl(value,default_value)</td>
<td style="text-align:left">如果value值为NULL就返回default_value,否则返回value</td>
</tr>
<tr>
<td style="text-align:left">coalesce(T v1, T v2, …)</td>
<td style="text-align:left">返回第一非null的值，如果全部都为NULL就返回NUL</td>
</tr>
<tr>
<td style="text-align:left">isnull( a )/isnotnull( a )</td>
<td style="text-align:left">判断返回boolean</td>
</tr>
<tr>
<td style="text-align:left">row_number() over</td>
<td style="text-align:left">分组排序</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> *,row_number() <span class="keyword">OVER</span> (<span class="keyword">partition</span> <span class="keyword">by</span> deptid <span class="keyword">order</span> <span class="keyword">by</span> salary <span class="keyword">desc</span>) <span class="keyword">as</span> rk <span class="keyword">from</span> employee;</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 备份</span></span><br><span class="line">empl=(`hive -e "show partitions employee;"`)</span><br><span class="line">emp2=(`hive -e "show partitions employee_backup;"`)</span><br><span class="line">for((i=1;i&lt;$&#123;#empl[@]&#125;;i++))</span><br><span class="line">do</span><br><span class="line">  update=$&#123;#empl[@]&#125;</span><br><span class="line">  tmp=(`echo $&#123;emp2[@]&#125; | grep $&#123;update&#125;`)</span><br><span class="line"></span><br><span class="line">  if [ -z $&#123;tmp&#125; ]</span><br><span class="line">  then</span><br><span class="line">    hive "</span><br><span class="line">    insert overwrite table tmp2 partition($&#123;update&#125;)</span><br><span class="line">    select `(y|m|d)?+.+` from  employee where $&#123;update&#125;</span><br><span class="line">    ;" </span><br><span class="line">    printf "%-20s\n" $&#123;update&#125; &gt; info </span><br><span class="line">  fi </span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:left">日期时间函数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">from_unixtime(int unixtime)</td>
<td style="text-align:left">转换的秒数从Unix纪元(1970-01-0100:00:00 UTC)</td>
</tr>
<tr>
<td style="text-align:left">to_date(string timestamp)</td>
<td style="text-align:left">返回一个字符串时间戳的日期部分</td>
</tr>
<tr>
<td style="text-align:left">date_format(date,format)</td>
<td style="text-align:left">按制定格式返回日期<br><a href="https://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html" target="_blank" rel="noopener">Format参考文献</a></td>
</tr>
<tr>
<td style="text-align:left">year(string date)</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">quarter(string date)</td>
<td style="text-align:left">季度</td>
</tr>
<tr>
<td style="text-align:left">month(string date)</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">day(string date)</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">current_date()</td>
<td style="text-align:left">当前日期</td>
</tr>
<tr>
<td style="text-align:left">weekofyear(string date)</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">datediff(start，end)</td>
<td style="text-align:left">返回相差天数</td>
</tr>
<tr>
<td style="text-align:left">months_between(date,date)</td>
<td style="text-align:left">相差月份</td>
</tr>
<tr>
<td style="text-align:left">date_add()/date_sub()</td>
<td style="text-align:left">日期加/减若干天数</td>
</tr>
<tr>
<td style="text-align:left">add_months(date,int)</td>
<td style="text-align:left">日期加若干月</td>
</tr>
<tr>
<td style="text-align:left">last_day(date)</td>
<td style="text-align:left">这个月最后一天</td>
</tr>
<tr>
<td style="text-align:left">trunc(date,format)</td>
<td style="text-align:left">年（“YY”）或月（“MM”）的第一天</td>
</tr>
<tr>
<td style="text-align:left">next_day(date,string day_of_week)</td>
<td style="text-align:left">下个周X对应的日期</td>
</tr>
<tr>
<td style="text-align:left">get_json_object(string json_string, string path)</td>
<td style="text-align:left"></td>
</tr>
</tbody>
</table>
<h1 id="hive视图和索引"><a class="markdownIt-Anchor" href="#hive视图和索引"></a> Hive视图和索引</h1>
<ul>
<li><strong>视图：</strong> 逻辑表，不存储实际数据</li>
<li><strong>索引：</strong></li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--创建视图</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> [<span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] view_name </span><br><span class="line">(column_name <span class="keyword">COMMENT</span> <span class="string">'列说明'</span>, ...)</span><br><span class="line">TBLPROPERTIES (property_name = property_value, ...)</span><br><span class="line"><span class="keyword">COMMENT</span> <span class="string">'视图注释'</span></span><br><span class="line"><span class="keyword">AS</span> <span class="keyword">SELECT</span> ...;</span><br><span class="line"><span class="comment">--删除试图</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> view_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">--创建索引</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> index_name</span><br><span class="line"><span class="keyword">ON</span> <span class="keyword">TABLE</span> base_table_name (col_name, ...)</span><br><span class="line"><span class="keyword">AS</span> <span class="string">'index.handler.class.name'</span></span><br><span class="line">[<span class="keyword">WITH</span> <span class="keyword">DEFERRED</span> <span class="keyword">REBUILD</span>]</span><br><span class="line">[IDXPROPERTIES (property_name=property_value, ...)]</span><br><span class="line">[<span class="keyword">IN</span> <span class="keyword">TABLE</span> index_table_name]</span><br><span class="line">[PARTITIONED <span class="keyword">BY</span> (col_name, ...)]</span><br><span class="line">[ <span class="keyword">ROW</span> <span class="keyword">FORMAT</span> ...] [<span class="keyword">STORED</span> <span class="keyword">AS</span> ...| <span class="keyword">STORED</span> <span class="keyword">BY</span> ...]</span><br><span class="line">[LOCATION hdfs_path]</span><br><span class="line">[TBLPROPERTIES (...)];</span><br><span class="line"><span class="comment">--删除索引</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">INDEX</span> &lt;index_name&gt; <span class="keyword">ON</span> &lt;table_name&gt;</span><br></pre></td></tr></table></figure>
<h1 id="hive性能调优"><a class="markdownIt-Anchor" href="#hive性能调优"></a> Hive性能调优</h1>
<p><a href="https://blog.csdn.net/myproudcodelife/article/details/45372467" target="_blank" rel="noopener">https://blog.csdn.net/myproudcodelife/article/details/45372467</a></p>
<h1 id="部分hadoop命令"><a class="markdownIt-Anchor" href="#部分hadoop命令"></a> 部分Hadoop命令</h1>
<p><a href="https://blog.csdn.net/m0_38003171/article/details/79086780" target="_blank" rel="noopener">https://blog.csdn.net/m0_38003171/article/details/79086780</a></p>
<hr>
<p>参考链接<br>
<a href="https://www.yiibai.com/hive" target="_blank" rel="noopener">https://www.yiibai.com/hive</a><br>
<a href="https://blog.csdn.net/u012386109/article/details/78214894" target="_blank" rel="noopener">https://blog.csdn.net/u012386109/article/details/78214894</a><br>
<a href="https://www.cnblogs.com/skyl/p/4736129.html" target="_blank" rel="noopener">https://www.cnblogs.com/skyl/p/4736129.html</a></p>

    </div>

    
    
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>

        
      
        <div id="reward-container">
  <div></div>
  <button id="reward-button" disable="enable" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
        
      
      <div style="display: inline-block">
        <img src="/images/nezha.jpg" alt="Wilen Wu 开玩笑">
        <p>开玩笑</p>
      </div>

  </div>
</div>

      
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Wilen Wu</li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://wilenwu.github.io/posts/big-data/BigDataNotebook(Hive)--HiveQL.html" title="大数据手册(Hive)--HiveQL">https://wilenwu.github.io/posts/big-data/BigDataNotebook(Hive)--HiveQL.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li>
</ul>
</div>

      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/大数据/" rel="tag"># 大数据</a>
            
              <a href="/tags/hive/" rel="tag"># hive</a>
            
              <a href="/tags/SQL/" rel="tag"># SQL</a>
            
              <a href="/tags/hiveQL/" rel="tag"># hiveQL</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/posts/big-data/BigDataNotebook(Spark)--Spark-installation.html" rel="next" title="大数据手册(Spark)--Spark安装配置">
                  <i class="fa fa-chevron-left"></i> 大数据手册(Spark)--Spark安装配置
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/posts/big-data/SQLNotebook.html" rel="prev" title="SQL手册">
                  SQL手册 <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          
    
      <div class="tabs tabs-comment">
        <ul class="nav-tabs">
          
            <li class="tab"><a href="#comment-gitalk">gitalk</a></li>
          
            <li class="tab"><a href="#comment-valine">valine</a></li>
          
        </ul>
        <div class="tab-content">
          
            <div class="tab-pane gitalk" id="comment-gitalk">
              <div class="comments" id="gitalk-container"></div>
            </div>
          
            <div class="tab-pane valine" id="comment-valine">
              <div class="comments" id="comments"></div>
            </div>
          
        </div>
      </div>
      <script>
        window.addEventListener('tabs:register', () => {
          let activeClass = 'gitalk';
          
            activeClass = localStorage.getItem('comments_active') || activeClass;
          
          if (activeClass) {
            let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
            if (activeTab) {
              activeTab.click();
            }
          }
        });
        
        window.addEventListener('tabs:click', event => {
          let commentClass = event.target.classList[1];
          localStorage.setItem('comments_active', commentClass);
        });
        
      </script>
    
  

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#hive交互"><span class="nav-number">1.</span> <span class="nav-text"> Hive交互</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#hive内置运算符"><span class="nav-number">2.</span> <span class="nav-text"> Hive内置运算符</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#hive数据类型"><span class="nav-number">3.</span> <span class="nav-text"> Hive数据类型</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#hive的数据存储"><span class="nav-number">4.</span> <span class="nav-text"> Hive的数据存储</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#hiveql常用语句"><span class="nav-number">5.</span> <span class="nav-text"> HiveQL常用语句</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#创建删除数据库"><span class="nav-number">5.1.</span> <span class="nav-text"> 创建/删除数据库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建删除表"><span class="nav-number">5.2.</span> <span class="nav-text"> 创建/删除表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#修改表结构"><span class="nav-number">5.3.</span> <span class="nav-text"> 修改表结构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#导入导出数据"><span class="nav-number">5.4.</span> <span class="nav-text"> 导入导出数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#插入数据"><span class="nav-number">5.5.</span> <span class="nav-text"> 插入数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#查询语句"><span class="nav-number">5.6.</span> <span class="nav-text"> 查询语句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#表连接"><span class="nav-number">5.7.</span> <span class="nav-text"> 表连接</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#表联合"><span class="nav-number">5.8.</span> <span class="nav-text"> 表联合</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#其他常用命令"><span class="nav-number">5.9.</span> <span class="nav-text"> 其他常用命令</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#hive常用内置函数"><span class="nav-number">6.</span> <span class="nav-text"> Hive常用内置函数</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#hive视图和索引"><span class="nav-number">7.</span> <span class="nav-text"> Hive视图和索引</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#hive性能调优"><span class="nav-number">8.</span> <span class="nav-text"> Hive性能调优</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#部分hadoop命令"><span class="nav-number">9.</span> <span class="nav-text"> 部分Hadoop命令</span></a></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image"
      src="/images/header.jpg"
      alt="Wilen Wu">
  <p class="site-author-name" itemprop="name">Wilen Wu</p>
  <div class="site-description" itemprop="description">个人技术博客</div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">60</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
          
            <a href="/categories/">
          
        
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">分类</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        <span class="site-state-item-count">111</span>
        <span class="site-state-item-name">标签</span>
        </a>
      </div>
    
  </nav>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://github.com/wilenwu" title="GitHub &rarr; https://github.com/wilenwu" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://blog.csdn.net/qq_41518277" title="CSDN &rarr; https://blog.csdn.net/qq_41518277" rel="noopener" target="_blank"><i class="fa fa-fw fa-book"></i>CSDN</a>
      </span>
    
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
      

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Wilen Wu</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    <span title="站点总字数">287k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">4:21</span>
</div>

        












        
      </div>
    </footer>
  </div>

  


    
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
<script src="/js/utils.js?v=7.4.0"></script><script src="/js/motion.js?v=7.4.0"></script>
<script src="/js/schemes/pisces.js?v=7.4.0"></script>

<script src="/js/next-boot.js?v=7.4.0"></script>



  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>








  <script src="/js/local-search.js?v=7.4.0"></script>










<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme: 'forest',
      logLevel: 3,
      flowchart: { curve: 'linear' },
      gantt: { axisFormat: '%m/%d/%Y' },
      sequence: { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>




<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '60decc199e52a19f035d',
      clientSecret: 'fe95a75c03105bf4566a72968f6dfcfd3b861344',
      repo: 'gitalk',
      owner: 'wilenwu',
      admin: ['wilenwu'],
      id: '3be7aa98d992907175cbd79c194399f2',
        language: 'zh-CN',
      
      distractionFreeMode: 'true'
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
</script>


  

  

  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '60decc199e52a19f035d',
      clientSecret: 'fe95a75c03105bf4566a72968f6dfcfd3b861344',
      repo: 'gitalk',
      owner: 'wilenwu',
      admin: ['wilenwu'],
      id: 'c21429c774cb6347d428a0f35301755e',
        language: 'zh-CN',
      
      distractionFreeMode: 'true'
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
</script>


<script>
NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
  var GUEST = ['nick', 'mail', 'link'];
  var guest = 'nick,mail,link';
  guest = guest.split(',').filter(item => {
    return GUEST.includes(item);
  });
  new Valine({
    el: '#comments',
    verify: false,
    notify: false,
    appId: 'xuVMHtcFR2bEYRTuPIjJUT6b-MdYXbMMI',
    appKey: '6EzBICTWxLbjiGsbNAa8Fv2s',
    placeholder: 'Just go go',
    avatar: 'mm',
    meta: guest,
    pageSize: '10' || 10,
    visitor: true,
    lang: 'zh-cn' || 'zh-cn',
    path: location.pathname
  });
}, window.Valine);
</script>

</body>
</html>
